<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CityLens åŸå¸‚é€é•œ v3.0</title>
    <style>
        :root {
            --primary: #00E5FF; /* PolyU Cyan */
            --accent: #FF0055; /* Z-score Red */
            --bg: #121212;
            --card-bg: #1E1E1E;
            --text: #E0E0E0;
            --text-dim: #A0A0A0;
            --slider-track: #333;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 15px;
            padding-bottom: 120px;
        }

        h1 { font-size: 1.2rem; color: var(--primary); text-align: center; margin: 10px 0; }
        p.subtitle { text-align: center; font-size: 0.8rem; color: var(--text-dim); margin-bottom: 20px; }

        /* Card Style */
        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #333;
            position: relative;
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            border-bottom: 1px solid #333;
            padding-bottom: 8px;
        }

        .icon { font-size: 1.4rem; margin-right: 8px; }
        .card-title { font-weight: bold; font-size: 1rem; color: #fff; }

        /* Photo Upload Styling */
        .photo-upload-box {
            border: 2px dashed #444;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
            position: relative;
            overflow: hidden;
        }
        .photo-upload-box:active { border-color: var(--primary); }
        .photo-preview {
            max-width: 100%;
            max-height: 200px;
            display: none;
            margin-top: 10px;
            border-radius: 4px;
        }
        input[type="file"] { display: none; }

        /* Question Group */
        .q-group { margin-bottom: 20px; border-bottom: 1px dashed #333; padding-bottom: 15px; }
        .q-group:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        
        .q-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            margin-bottom: 8px;
        }

        .q-tag {
            background: #2a2a2a;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7rem;
            color: var(--primary);
            margin-left: 5px;
        }
        
        /* Special tags for X1 X2 */
        .tag-x { color: #FF9800; } 

        /* Value Display */
        .val-display {
            font-family: monospace;
            font-size: 1.1rem;
            color: var(--primary);
            font-weight: bold;
            min-width: 30px;
            text-align: right;
        }

        /* Description Box */
        .desc-text {
            font-size: 0.8rem;
            color: #ccc;
            background: #252525;
            padding: 8px;
            border-radius: 6px;
            margin-top: 5px;
            line-height: 1.4;
            border-left: 3px solid #444;
            transition: all 0.2s;
        }
        .desc-text.highlight { border-left-color: var(--primary); background: #2a2a2a; }

        /* Slider Styling - Fixed Vendor Prefix */
        input[type=range] {
            -webkit-appearance: none;
            appearance: none; /* Added standard property */
            width: 100%;
            background: transparent;
            margin: 10px 0;
        }
        input[type=range]:focus { outline: none; }
        
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: var(--slider-track);
            border-radius: 3px;
        }
        
        input[type=range]::-webkit-slider-thumb {
            height: 22px;
            width: 22px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            margin-top: -8px;
            box-shadow: 0 0 8px rgba(0, 229, 255, 0.4);
            border: 2px solid #fff;
        }

        /* Z-Slider Specific */
        .z-slider::-webkit-slider-thumb { background: var(--accent); box-shadow: 0 0 8px rgba(255, 0, 85, 0.4); }

        /* Submit Button */
        .fab-container {
            position: fixed;
            bottom: 0; left: 0; width: 100%;
            padding: 15px 20px 25px;
            background: linear-gradient(to top, rgba(18,18,18,1) 85%, transparent);
            box-sizing: border-box;
            z-index: 100;
            display: flex;
            gap: 10px;
        }
        
        button {
            border: none;
            border-radius: 30px;
            padding: 14px;
            font-weight: bold;
            font-size: 1rem;
            cursor: pointer;
            flex: 1;
        }

        .submit-btn { background: var(--primary); color: #000; box-shadow: 0 4px 12px rgba(0, 229, 255, 0.3); }
        .reset-btn { background: #333; color: #fff; flex: 0.3; }

        .input-text {
            width: 100%; padding: 10px;
            background: #333; border: 1px solid #444;
            color: white; border-radius: 6px;
            box-sizing: border-box;
        }
    </style>
</head>
<body>

    <h1>CitySense åŸå¸‚ç¯å¢ƒæ¢æŸ¥å¹³å° v3.0</h1>
    <p class="subtitle">æ»‘åŠ¨ä»¥åŒ¹é…æè¿° (-3 è‡³ +3)</p>

    <div class="card">
        <div class="card-header">
            <span class="icon">ğŸ“¸</span>
            <span class="card-title">ä½ç½®ä¸å­˜è¯</span>
        </div>
        <div style="margin-bottom: 15px;">
            <input type="text" id="locID" class="input-text" placeholder="è¾“å…¥ç‚¹ä½ç¼–å· (å¦‚ K11-North)">
        </div>
        
        <label class="photo-upload-box" for="cameraInput">
            <span style="font-size:1.5rem">ğŸ“·</span><br>
            <span style="font-size:0.8rem; color:#aaa">ç‚¹å‡»æ‹ç…§æˆ–ä¸Šä¼ å›¾ç‰‡</span>
            <img id="preview" class="photo-preview">
        </label>
        <input type="file" id="cameraInput" accept="image/*" capture="environment" onchange="previewImage(this)">
    </div>

    <div class="card" style="border-top: 3px solid var(--accent);">
        <div class="card-header">
            <span class="icon">ğŸ§ </span>
            <span class="card-title">Zå€¼: ç›´è§‰æ•´ä½“è¯„åˆ†</span>
        </div>
        <div class="q-group">
            <div class="q-label">
                <span>ç›´è§‰æ„Ÿå—</span>
                <span id="val_Z" class="val-display" style="color:var(--accent)">50</span>
            </div>
            <input type="range" min="0" max="100" value="50" class="z-slider" oninput="updateZ(this.value)">
            <div class="desc-text" id="desc_Z">50: æ— åŠŸæ— è¿‡ï¼Œä¸­æ€§</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span class="icon">ğŸŒ¿</span><span class="card-title">S1 è‡ªç„¶æ™¯è§‚</span></div>
        
        <div class="q-group">
            <div class="q-label"><span>ç»¿åŒ–å­˜åœ¨åº¦</span><span class="q-tag">E: Existence</span><span id="val_S1_E" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S1_E', this.value)">
            <div class="desc-text" id="desc_S1_E">0: ä¸­ç­‰...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>ç”Ÿæ€å¥åº·åº¦</span><span class="q-tag">Q: Quality</span><span id="val_S1_Q" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S1_Q', this.value)">
            <div class="desc-text" id="desc_S1_Q">0: ä¸€èˆ¬...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>é™æ¸©äº²å’Œæ„Ÿ</span><span class="q-tag tag-x">X1: Cooling</span><span id="val_S1_X1" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S1_X1', this.value)">
            <div class="desc-text" id="desc_S1_X1">0: æ— æ„Ÿ...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>ç”Ÿå‘½æ²»æ„ˆæ„Ÿ</span><span class="q-tag tag-x">X2: Healing</span><span id="val_S1_X2" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S1_X2', this.value)">
            <div class="desc-text" id="desc_S1_X2">0: ä¸€èˆ¬...</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span class="icon">ğŸ—ï¸</span><span class="card-title">S2 ç©ºé—´ç»“æ„</span></div>
        
        <div class="q-group">
            <div class="q-label"><span>ç•Œé¢æ¸…æ™°åº¦</span><span class="q-tag">E: Existence</span><span id="val_S2_E" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S2_E', this.value)">
            <div class="desc-text" id="desc_S2_E">0: ä¸­ç­‰...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>ç©ºé—´ç§©åºæ„Ÿ</span><span class="q-tag">Q: Quality</span><span id="val_S2_Q" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S2_Q', this.value)">
            <div class="desc-text" id="desc_S2_Q">0: ä¸€èˆ¬...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>ç©ºé—´å¼€æ•åº¦</span><span class="q-tag tag-x">X1: Openness</span><span id="val_S2_X1" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S2_X1', this.value)">
            <div class="desc-text" id="desc_S2_X1">0: ä¸€èˆ¬...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>è¡Œèµ°æµç•…åº¦</span><span class="q-tag tag-x">X2: Smoothness</span><span id="val_S2_X2" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S2_X2', this.value)">
            <div class="desc-text" id="desc_S2_X2">0: ä¸€èˆ¬...</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span class="icon">ğŸ¨</span><span class="card-title">S3 ç¾å­¦ç‰¹å¾</span></div>
        
        <div class="q-group">
            <div class="q-label"><span>è§†è§‰ä¸°å¯Œåº¦</span><span class="q-tag">E: Existence</span><span id="val_S3_E" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S3_E', this.value)">
            <div class="desc-text" id="desc_S3_E">0: æ™®é€š...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>å·¥è‰ºåè°ƒæ€§</span><span class="q-tag">Q: Quality</span><span id="val_S3_Q" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S3_Q', this.value)">
            <div class="desc-text" id="desc_S3_Q">0: å¸¸è§„...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>è§†è§‰å’Œè°åº¦</span><span class="q-tag tag-x">X1: Harmony</span><span id="val_S3_X1" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S3_X1', this.value)">
            <div class="desc-text" id="desc_S3_X1">0: æ— æ„Ÿ...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>æ™¯è§‚å¸å¼•åŠ›</span><span class="q-tag tag-x">X2: Attraction</span><span id="val_S3_X2" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S3_X2', this.value)">
            <div class="desc-text" id="desc_S3_X2">0: æ— æ„Ÿ...</div>
        </div>
    </div>

    <div class="card">
        <div class="card-header"><span class="icon">ğŸª‘</span><span class="card-title">S4 ç¤¾ä¼šå¯ä¾›æ€§</span></div>
        
        <div class="q-group">
            <div class="q-label"><span>è®¾æ–½å¯†åº¦</span><span class="q-tag">E: Existence</span><span id="val_S4_E" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S4_E', this.value)">
            <div class="desc-text" id="desc_S4_E">0: ä¸­ç­‰...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>äººä½“å·¥å­¦</span><span class="q-tag">Q: Quality</span><span id="val_S4_Q" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S4_Q', this.value)">
            <div class="desc-text" id="desc_S4_Q">0: å¯ç”¨...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>åœç•™æ”¯æŒæ€§</span><span class="q-tag tag-x">X1: Support</span><span id="val_S4_X1" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S4_X1', this.value)">
            <div class="desc-text" id="desc_S4_X1">0: ä¸€èˆ¬...</div>
        </div>
        <div class="q-group">
            <div class="q-label"><span>ç¤¾äº¤å®‰å…¨æ„Ÿ</span><span class="q-tag tag-x">X2: Security</span><span id="val_S4_X2" class="val-display">0</span></div>
            <input type="range" min="-3" max="3" step="1" value="0" oninput="updateDesc('S4_X2', this.value)">
            <div class="desc-text" id="desc_S4_X2">0: ä¸€èˆ¬...</div>
        </div>
    </div>

    <div class="fab-container">
        <button class="reset-btn" onclick="resetForm()">é‡ç½®</button>
        <button class="submit-btn" onclick="exportData()">å¤åˆ¶æ•°æ®</button>
    </div>

    <script>
        // === æ ¸å¿ƒæ•°æ®å­—å…¸ï¼šåŒXå˜é‡å®šä¹‰ ===
        const defs = {
            // --- S1 è‡ªç„¶æ™¯è§‚ ---
            S1_E: {
                "-3": "[-3] æåº¦ç¼ºå¤±: ç»¿è‰²å æ¯”<5%ï¼Œæ»¡çœ¼æ°´æ³¥",
                "0": "[0] ä¸­ç­‰: è¿ç»­è¡Œé“æ ‘ï¼Œæ„Ÿå—ç»¿æ„ï¼Œå æ¯”15-30%",
                "3": "[3] æåº¦ä¸°å¯Œ: éƒé—­é®å¤©ï¼Œç»¿è‰²å æ¯”>60%"
            },
            S1_Q: { "-3": "[-3] æ¯æ­»/è£¸éœ²", "0": "[0] ä¸€èˆ¬/æ— åŠŸæ— è¿‡", "3": "[3] ç²¾å“å›­è‰º/ç»´æŠ¤æä½³" },
            S1_X1: { // é™æ¸©äº²å’Œ
                "-3": "[-3] æš´æ™’: é˜³å…‰åˆºçœ¼ï¼Œæåº¦é—·çƒ­",
                "0": "[0] æ— æ„Ÿ: ä¸è§‰å¾—çƒ­",
                "3": "[3] å‡‰çˆ½: æ ‘è«æµ“å¯†ï¼Œä½“æ„Ÿæä½³"
            },
            S1_X2: { // æ²»æ„ˆç”Ÿå‘½
                "-3": "[-3] è§æ¡: æ¯«æ— ç”Ÿæœºï¼Œæ„Ÿåˆ°å‹æŠ‘",
                "0": "[0] å¹³å¸¸: æ™®é€šçš„ç»¿åŒ–",
                "3": "[3] æ²»æ„ˆ: ç”Ÿæœºå‹ƒå‹ƒï¼Œå¿ƒçµæ”¾æ¾"
            },

            // --- S2 ç©ºé—´ç»“æ„ ---
            S2_E: {
                "-3": "[-3] æå¼±/è’èŠœ: æ— è¾¹ç•Œ",
                "0": "[0] ä¸­ç­‰: D/Hâ‰ˆ1ï¼Œç•Œé¢æ˜ç¡®",
                "3": "[3] æå¼º/åŒ…è£¹: çª„å··/è¿å»Šï¼ŒåŒ…è£¹æ„Ÿå¼º"
            },
            S2_Q: { "-3": "[-3] æ··ä¹±/è¿å»º", "0": "[0] æ•´æ´/å¹³æ•´", "3": "[3] æåº¦æœ‰åº/ç²¾è‡´" },
            S2_X1: { // ç©ºé—´å¼€æ•
                "-3": "[-3] æåº¦å‹æŠ‘: è¢«é«˜æ¥¼æŒ¤å‹",
                "0": "[0] é€‚ä¸­",
                "3": "[3] å¼€é˜”: è§†çº¿é€šé€ï¼Œå°ºåº¦å®œäºº"
            },
            S2_X2: { // è¡Œèµ°æµç•…
                "-3": "[-3] æ‹¥å µ: é¢‘ç¹é¿è®©",
                "0": "[0] æ­£å¸¸",
                "3": "[3] æµç•…: è¡Œèµ°å¦‚é£"
            },

            // --- S3 ç¾å­¦ç‰¹å¾ ---
            S3_E: {
                "-3": "[-3] è´«ä¹: å¤§ç™½å¢™/æ°´æ³¥",
                "0": "[0] æ™®é€š: å¸¸è§è‰²å½©",
                "3": "[3] å¼ºçƒˆ: è‰ºæœ¯è£…ç½®/å¤æ‚çº¹ç†"
            },
            S3_Q: { "-3": "[-3] å»‰ä»·/ç ´æŸ", "0": "[0] å¸¸è§„/å®Œå¥½", "3": "[3] è‰ºæœ¯çº§/é«˜çº§æè´¨" },
            S3_X1: { // è§†è§‰å’Œè°
                "-3": "[-3] æ‚ä¹±: çœ‹ç€çœ¼æ™•",
                "0": "[0] é¡ºçœ¼",
                "3": "[3] å’Œè°: é…è‰²ç»Ÿä¸€ï¼Œç§©åºäº•ç„¶"
            },
            S3_X2: { // æ™¯è§‚å¸å¼•
                "-3": "[-3] ä¸‘é™‹/æƒ³é¿å¼€",
                "0": "[0] è®°ä¸ä½",
                "3": "[3] æƒŠè‰³: å¿ä¸ä½æƒ³æ‹ç…§"
            },

            // --- S4 ç¤¾ä¼šå¯ä¾›æ€§ ---
            S4_E: {
                "-3": "[-3] æ’æ–¥: é˜²åé’‰/ä»…è½¦é“",
                "0": "[0] ä¸­ç­‰: å¶æœ‰çŸ³å¢©",
                "3": "[3] ä¸°å¯Œ: è¿ç»­ä¼‘æ¯åŒº/å¹¿åœº"
            },
            S4_Q: { "-3": "[-3] è„/å/ç§¯æ°´", "0": "[0] å¯ç”¨/æ— é èƒŒ", "3": "[3] èˆ’é€‚/äººä½“å·¥å­¦" },
            S4_X1: { // åœç•™æ”¯æŒ
                "-3": "[-3] ç´¯/æ— å¤„å¯å»",
                "0": "[0] ä¸€èˆ¬",
                "3": "[3] æ”¯æŒ: éšæ—¶èƒ½åœä¸‹æ¥ä¼‘æ¯"
            },
            S4_X2: { // ç¤¾äº¤å®‰å…¨
                "-3": "[-3] ä¸å®‰/å°´å°¬/è¢«ç›‘è§†",
                "0": "[0] ä¸€èˆ¬",
                "3": "[3] å®‰å…¨: åƒå®¶ä¸€æ ·è‡ªåœ¨"
            }
        };

        // åˆå§‹åŒ–
        window.onload = function() {
            Object.keys(defs).forEach(key => updateDesc(key, 0));
        };

        // æ›´æ–°Zå€¼
        function updateZ(val) {
            document.getElementById("val_Z").innerText = val;
            let text = val < 40 ? "ä»¤äººå‹æŠ‘" : (val < 70 ? "ä¸­æ€§æ— æ„Ÿ" : "ä»¤äººæ²»æ„ˆ");
            document.getElementById("desc_Z").innerText = `${val}: ${text}`;
        }

        // æ›´æ–°é€šç”¨æè¿°
        function updateDesc(key, val) {
            let displayVal = val > 0 ? "+" + val : val;
            document.getElementById("val_" + key).innerText = displayVal;
            
            // ç®€å•æ¨æ–­é€»è¾‘ (å¦‚æœå­—å…¸é‡Œæ²¡æœ‰å®šä¹‰-1/-2ç­‰ä¸­é—´å€¼)
            let text = defs[key][val];
            if (!text) {
                if (val > 0) text = `[${val}] åå¥½/å¼º`;
                else if (val < 0) text = `[${val}] åå·®/å¼±`;
                else text = `[0] ä¸­æ€§`;
            }
            
            let descEl = document.getElementById("desc_" + key);
            descEl.innerText = text;
            descEl.classList.add("highlight");
            setTimeout(() => descEl.classList.remove("highlight"), 300);
        }

        // å›¾ç‰‡é¢„è§ˆ
        function previewImage(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    var img = document.getElementById('preview');
                    img.src = e.target.result;
                    img.style.display = 'block';
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            let loc = document.getElementById("locID").value || "æœªå‘½å";
            let z = document.getElementById("val_Z").innerText;
            
            // æŒ‰é¡ºåºæ”¶é›†æ‰€æœ‰ Slider (E, Q, X1, X2)
            let values = [];
            const keys = [
                "S1_E", "S1_Q", "S1_X1", "S1_X2",
                "S2_E", "S2_Q", "S2_X1", "S2_X2",
                "S3_E", "S3_Q", "S3_X1", "S3_X2",
                "S4_E", "S4_Q", "S4_X1", "S4_X2"
            ];
            
            keys.forEach(k => {
                values.push(document.getElementById("val_" + k).innerText);
            });

            let imgInfo = document.getElementById('cameraInput').files.length > 0 ? "Y" : "N";
            
            // CSV Header: Loc, Z, S1E, S1Q, S1X1, S1X2...
            let csvLine = `${loc},${z},${values.join(',')},${imgInfo}`;
            
            navigator.clipboard.writeText(csvLine).then(() => {
                alert(`âœ… å·²å¤åˆ¶!\næ ¼å¼: Loc,Z,S1E,S1Q,S1X1,S1X2...\n\n${csvLine}`);
            }).catch(() => {
                alert(`âŒ å¤åˆ¶å¤±è´¥:\n${csvLine}`);
            });
        }

        function resetForm() {
            if(confirm("é‡ç½®æ‰€æœ‰è¯„åˆ†ï¼Ÿ")) {
                document.querySelectorAll('input[type=range]').forEach(i => {
                    i.value = i.classList.contains('z-slider') ? 50 : 0;
                    i.oninput(); 
                });
                document.getElementById('locID').value = "";
                document.getElementById('preview').style.display = 'none';
                document.getElementById('cameraInput').value = "";
                window.scrollTo(0,0);
            }
        }
    </script>
</body>
</html>